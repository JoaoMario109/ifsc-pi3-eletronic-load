Version 4
SHEET 1 2884 1924
WIRE -416 192 -416 144
WIRE -240 192 -240 144
WIRE -416 272 -416 224
WIRE -240 272 -240 224
WIRE 1568 752 1568 672
WIRE 2048 816 1824 816
WIRE 1568 864 1568 816
WIRE 1568 976 1568 928
WIRE 1824 1024 1824 816
WIRE 1008 1056 976 1056
WIRE 1136 1056 1088 1056
WIRE 1184 1056 1136 1056
WIRE 1296 1056 1264 1056
WIRE 1568 1088 1568 1040
WIRE 1296 1120 1296 1056
WIRE 1824 1184 1824 1104
WIRE 2048 1184 2048 816
WIRE 2128 1184 2048 1184
WIRE 2384 1184 2384 1168
WIRE 2384 1184 2320 1184
WIRE 1568 1200 1568 1152
WIRE 1200 1216 1200 1168
WIRE 2544 1216 2416 1216
WIRE 1136 1232 1136 1056
WIRE 1168 1232 1136 1232
WIRE 2416 1232 2416 1216
WIRE 2416 1232 2320 1232
WIRE 2544 1232 2544 1216
WIRE 1296 1248 1296 1120
WIRE 1296 1248 1232 1248
WIRE 1328 1248 1296 1248
WIRE 1504 1248 1408 1248
WIRE 1168 1264 1152 1264
WIRE 176 1296 176 1248
WIRE 224 1296 176 1296
WIRE 640 1296 560 1296
WIRE 784 1296 720 1296
WIRE 912 1296 848 1296
WIRE 2128 1312 1936 1312
WIRE 1200 1328 1200 1280
WIRE 2352 1328 2320 1328
WIRE 976 1344 976 1056
WIRE 1568 1344 1568 1296
WIRE 2352 1344 2352 1328
WIRE 2416 1344 2416 1312
WIRE 2416 1344 2352 1344
WIRE 1152 1376 1152 1264
WIRE 1184 1376 1152 1376
WIRE 2352 1376 2352 1344
WIRE 176 1392 176 1296
WIRE 224 1392 176 1392
WIRE 304 1392 304 1296
WIRE 304 1392 288 1392
WIRE 336 1392 304 1392
WIRE 480 1392 416 1392
WIRE 560 1392 560 1296
WIRE 560 1392 480 1392
WIRE 2544 1392 2544 1312
WIRE 2576 1392 2544 1392
WIRE 656 1424 656 1408
WIRE 1072 1424 1040 1424
WIRE 1184 1424 1184 1376
WIRE 1184 1424 1152 1424
WIRE 1248 1424 1184 1424
WIRE 1360 1424 1328 1424
WIRE 560 1440 560 1392
WIRE 624 1440 560 1440
WIRE 912 1456 912 1296
WIRE 912 1456 688 1456
WIRE 976 1456 976 1344
WIRE 976 1456 912 1456
WIRE 624 1472 560 1472
WIRE 1040 1472 1040 1424
WIRE 1568 1504 1568 1424
WIRE 1568 1504 1504 1504
WIRE 1616 1504 1568 1504
WIRE 176 1520 176 1392
WIRE 288 1520 176 1520
WIRE 480 1520 480 1392
WIRE 480 1520 368 1520
WIRE 560 1520 560 1472
WIRE 656 1520 656 1488
WIRE 1936 1584 1936 1312
WIRE 1936 1584 1808 1584
WIRE 2064 1584 1936 1584
WIRE 560 1600 560 1520
WIRE 1808 1616 1808 1584
WIRE 2064 1616 2064 1584
WIRE 560 1664 560 1632
WIRE 1632 1664 1600 1664
WIRE 1744 1664 1712 1664
WIRE 1904 1664 1872 1664
WIRE 2000 1664 1984 1664
WIRE 176 1744 176 1520
WIRE 1808 1776 1808 1712
WIRE 2064 1776 2064 1712
WIRE 1808 1904 1808 1856
WIRE 2064 1904 2064 1856
FLAG -240 144 vcc
FLAG -240 272 0
FLAG 560 1664 0
FLAG 1808 1904 0
FLAG 1824 1184 0
FLAG 656 1408 vcc
FLAG 656 1520 0
FLAG 2384 1168 +3.3V
FLAG 2352 1376 0
FLAG -416 144 +3.3V
FLAG -416 272 0
FLAG 1568 672 vcc
FLAG 2064 1904 0
FLAG 1872 1664 B2
FLAG 1600 1664 B1
FLAG 1504 1504 B1
FLAG 1616 1504 B2
FLAG 1200 1328 0
FLAG 1200 1168 vcc
FLAG 2576 1392 i_sensor
FLAG 176 1744 i_sensor
FLAG 1360 1424 vcc
FLAG 1040 1472 0
FLAG 976 1344 control_action
FLAG 1296 1120 _control_action
FLAG 560 1520 setpoint
SYMBOL MiniSyms4\\voltage- -240 208 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL EXTRA\\ExtraOpamps\\LM324_ST 656 1456 R0
SYMATTR InstName U3
SYMBOL res 384 1504 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 720
SYMBOL cap 288 1376 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL res 432 1376 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 5k
SYMBOL res 736 1280 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 330
SYMBOL cap 848 1280 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 10n
SYMBOL MiniSyms4\\voltage- 560 1616 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 0.4 0 1p 1p 0.5m 1m)
SYMBOL res 1792 1760 R0
SYMATTR InstName R15
SYMATTR Value 0.1
SYMBOL voltage 1824 1008 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName DUT
SYMATTR Value PULSE(5 12 0 0p 0p 1m 2m)
SYMBOL res 2400 1216 R0
SYMATTR InstName R16
SYMATTR Value 1k
SYMBOL Allegro\ Current\ Sensors\\ACS711 2240 1216 R0
SYMATTR InstName U5
SYMBOL MiniSyms4\\voltage- -416 208 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 3.3
SYMBOL npn 1744 1616 R0
SYMATTR InstName Q1
SYMBOL pnp 1504 1296 M180
SYMATTR InstName Q2
SYMATTR Value 2SB1375
SYMBOL diode 1552 1088 R0
SYMATTR InstName D3
SYMATTR Value LL4148
SYMBOL diode 1552 976 R0
SYMATTR InstName D4
SYMATTR Value LL4148
SYMBOL diode 1552 864 R0
SYMATTR InstName D5
SYMATTR Value LL4148
SYMBOL diode 1552 752 R0
SYMATTR InstName D6
SYMATTR Value LL4148
SYMBOL res 1584 1440 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R1
SYMATTR Value 10
SYMBOL res 2048 1760 R0
SYMATTR InstName R2
SYMATTR Value 0.1
SYMBOL npn 2000 1616 R0
SYMATTR InstName Q3
SYMBOL res 2000 1648 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 10
SYMBOL res 1728 1648 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10
SYMBOL res 1424 1232 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 2.7k
SYMBOL EXTRA\\ExtraOpamps\\LM324_ST 1200 1248 R0
SYMATTR InstName U1
SYMBOL res 1280 1040 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 3.3k
SYMBOL res 992 1072 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R9
SYMATTR Value 3.3k
SYMBOL res 1344 1408 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 3.3k
SYMBOL res 1056 1440 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R6
SYMATTR Value 3.3k
SYMBOL voltage 2544 1216 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 1.65
SYMBOL res 320 1280 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 1k
TEXT -272 600 Left 2 !.tran 0 16m 2m startup
TEXT 248 1744 Left 2 ;R10 -> reducing resistance increace velocity and ringing
TEXT -208 1088 Left 2 ;C3 -> increase capacitance decrease rise time and increase ringing
TEXT 520 1008 Left 2 ;C6 -> + capacitance = lower speed
